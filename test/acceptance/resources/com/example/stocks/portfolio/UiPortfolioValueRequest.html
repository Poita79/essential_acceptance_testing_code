<html xmlns:concordion="http://www.concordion.org/2007/concordion">
<head>
    <title>Example 2: Testing the outgoing messages</title>
    <link rel="stylesheet" href="../../../../concordion.css" type="text/css"/>
    <link rel="stylesheet" href="../../../../style.css" type="text/css"/>
    <script src="../../../../jquery-1.9.1.js">.</script>
    <script type="text/javascript" src="../../../../specifications.js">.</script>
</head>
<body onload="toggleImplementationNotes(); toggleDetails();">
<h1>Example 2: Testing the outgoing messages <img style="cursor:pointer" onclick="toggleImplementationNotes();" src="../../../../info.jpg" width="18px" height="18px" alt="Implementations notes" name="Toggle details"/></h1>

<div class="implementation-notes">
    <div class="information">
        <h2>Implementation notes</h2>

        <p>
            When the UI asks for a valuations, a specific message is sent over the wire. The response format is also
            exercised but how that value is actually used is left to another test. For example, if the request is
            sent as JSON, the JSON content may be verified. The response body may be verified against a specific JSON
            format and the HTTP response code verified to be 200 (OK).
        </p>
        <p>
            <img src="test-ui-to-portfolio.png" width="400px" height="120px" border="1px"/>
        </p>
        <p>
            <ul>
                <li>The web UI is started up</li>
                <li>The UI is used to click the 'request valuation' button</li>
                <li>Using a fake "application", an expectation on a specific HTTP request is verified</li>
                <li>How the UI uses a response is not part of this test, it verifies only that a response was received</li>
            </ul>
        </p>
    </div>
</div>

<p>
    What does it mean to ask for a portfolio value in the UI?
</p>

<h2>When</h2>

<p concordion:execute="#url = requestPortfolioValue()">
    When the user asks for the current portfolio valuation in the UI
</p>

<h2>Then</h2>

<p>
    A <b concordion:assertEquals="verifyHttpGet()">request for the portfolio value is made</b> to the application and the <b concordion:assertTrue="verifyResponseReturned()">response is returned</b> <span class="more-details">[<a href="#" onclick="toggleDetails();">details</a>]</span>
</p>

<div class="details">
    <div class="example">
        <p>
            A HTTP <code>GET</code> request is made to the following URL
        </p>
        <pre concordion:echo="#url"></pre>
    </div>
</div>

<div class="information">
    <h3>Further information</h3>
    <ul>
        <li><a href="index.html">Overview</a></li>
        <li><a href="UiPortfolioValueDisplay.html">How is the response displayed in the UI?</a></li>
    </ul>
</div>

</body>
</html>